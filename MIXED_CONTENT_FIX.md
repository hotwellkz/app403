# üö® –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã Mixed Content

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã

–í–∞—à —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ (https://2wix.ru) –Ω–µ –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –±—ç–∫–µ–Ω–¥—É –∏–∑-–∑–∞ **Mixed Content Error**:

```
Mixed Content: The page at 'https://2wix.ru' was loaded over HTTPS, 
but requested an insecure resource 'http://35.194.39.8:3000'. 
This request has been blocked.
```

## ‚úÖ –†–µ—à–µ–Ω–∏–µ –≤–Ω–µ–¥—Ä–µ–Ω–æ

–Ø —Å–æ–∑–¥–∞–ª –ø–æ–ª–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è —ç—Ç–æ–π –ø—Ä–æ–±–ª–µ–º—ã:

### üìÅ –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:
- `nginx-ssl.conf` - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è HTTPS –ø—Ä–æ–∫—Å–∏
- `setup-https-proxy.sh` - –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ SSL
- `HTTPS_SETUP_GUIDE.md` - –ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
- `src/config/api.ts` - –û–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è HTTPS

## üöÄ –ë—ã—Å—Ç—Ä–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –®–∞–≥ 1: –ó–∞–≥—Ä—É–∑–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –∫–æ–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

```bash
# –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ - –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Ñ–∞–π–ª—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä
scp nginx-ssl.conf setup-https-proxy.sh studo@35.194.39.8:~/app375/

# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh studo@35.194.39.8
cd ~/app375

# –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ Git
git pull origin main
```

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ HTTPS –ø—Ä–æ–∫—Å–∏

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ - –∑–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫—É HTTPS
chmod +x setup-https-proxy.sh
./setup-https-proxy.sh
```

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ GCP Firewall

```bash
# –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è –ø–æ—Ä—Ç–∞ 443 (HTTPS)
gcloud compute firewall-rules create https-whatsapp \
    --allow tcp:443 \
    --source-ranges 0.0.0.0/0 \
    --description 'HTTPS for WhatsApp Backend'
```

### –®–∞–≥ 4: –ü—Ä–∏–º–∏—Ç–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç

1. –û—Ç–∫—Ä–æ–π—Ç–µ **https://35.194.39.8** –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –ë—Ä–∞—É–∑–µ—Ä –ø–æ–∫–∞–∂–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ–º —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–µ
3. –ù–∞–∂–º–∏—Ç–µ **"–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ"** ‚Üí **"–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å–∞–π—Ç"**
4. –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –±—É–¥–µ—Ç –ø—Ä–∏–Ω—è—Ç

### –®–∞–≥ 5: –û–±–Ω–æ–≤–∏—Ç–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
VITE_BACKEND_URL=https://35.194.39.8

# –ò–ª–∏ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ, –æ–±–Ω–æ–≤–∏—Ç–µ –∫–æ–¥ –∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥
```

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:
```
[HTTPS Frontend] ‚Üí [HTTPS Nginx Proxy] ‚Üí [HTTP Backend]
   2wix.ru             35.194.39.8          localhost:3000
```

### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç Nginx –ø—Ä–æ–∫—Å–∏:
1. **–ü—Ä–∏–Ω–∏–º–∞–µ—Ç HTTPS –∑–∞–ø—Ä–æ—Å—ã** –Ω–∞ –ø–æ—Ä—Ç—É 443
2. **–ü—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –∫ HTTP –±—ç–∫–µ–Ω–¥—É** –Ω–∞ localhost:3000  
3. **–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç CORS** –¥–ª—è https://2wix.ru
4. **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç WebSocket** –¥–ª—è Socket.IO
5. **–†–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç HTTP‚ÜíHTTPS**

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

```bash
# 1. HTTPS endpoint
curl -k https://35.194.39.8/health

# 2. CORS –∑–∞–≥–æ–ª–æ–≤–∫–∏
curl -k -H "Origin: https://2wix.ru" https://35.194.39.8/health -v

# 3. –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤
sudo systemctl status nginx
docker ps | grep whatsapp

# 4. –ü–æ—Ä—Ç—ã
sudo netstat -tulpn | grep -E ':80|:443|:3000'
```

## üö® –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

### ‚úÖ –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:
```
üîó Backend URL: https://35.194.39.8
üîå Socket URL: https://35.194.39.8
‚úÖ Server status check: OK
‚úÖ WhatsApp status loaded
‚úÖ Contacts loaded: X contacts
‚úÖ Chats loaded: X chats
```

### ‚úÖ –ò—Å—á–µ–∑–Ω—É—Ç –æ—à–∏–±–∫–∏:
- ‚ùå Mixed Content errors
- ‚ùå Network errors  
- ‚ùå WebSocket connection failures
- ‚ùå CORS errors

## üîÑ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

–ï—Å–ª–∏ –æ—Å–Ω–æ–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

### –í–∞—Ä–∏–∞–Ω—Ç 1: ngrok (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
curl -s https://ngrok-agent.s3.amazonaws.com/ngrok.asc | sudo tee /etc/apt/trusted.gpg.d/ngrok.asc
echo "deb https://ngrok-agent.s3.amazonaws.com buster main" | sudo tee /etc/apt/sources.list.d/ngrok.list
sudo apt update && sudo apt install ngrok

# –°–æ–∑–¥–∞–Ω–∏–µ HTTPS —Ç—É–Ω–Ω–µ–ª—è
ngrok http 3000
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: Cloudflare (–¥–ª—è production)
1. –î–æ–±–∞–≤—å—Ç–µ –¥–æ–º–µ–Ω –≤ Cloudflare
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ DNS A-–∑–∞–ø–∏—Å—å –Ω–∞ 35.194.39.8
3. –í–∫–ª—é—á–∏—Ç–µ SSL/TLS –≤ Cloudflare

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

### –õ–æ–≥–∏ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:
```bash
# Nginx
sudo journalctl -u nginx -f

# Backend
docker logs whatsapp-backend-prod -f

# –°–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏
sudo dmesg | tail -20
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤:
```bash
# Nginx
sudo systemctl restart nginx

# Backend  
docker restart whatsapp-backend-prod

# –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞
sudo reboot
```

## üéØ –ò—Ç–æ–≥–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤:

- **Backend URL**: https://35.194.39.8
- **Frontend URL**: https://2wix.ru  
- **–ü–æ—Ä—Ç—ã**: 80‚Üí443 (redirect), 443 (HTTPS), 3000 (local backend)
- **SSL**: –°–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
- **CORS**: –ù–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è https://2wix.ru
- **WebSocket**: –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ HTTPS

–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –æ—à–∏–±–æ–∫ Mixed Content! üéâ 