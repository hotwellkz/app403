# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å Certbot –¥–ª—è api.2wix.ru

## üö® –ü—Ä–æ–±–ª–µ–º–∞

Certbot –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ–º–µ–Ω –∏–∑-–∑–∞:
1. **DNS –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–≤–∞ IP –∞–¥—Ä–µ—Å–∞:** `35.194.39.8` –∏ `159.255.37.158`
2. **HTTP —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ HTTPS** –¥–ª—è `/.well-known/acme-challenge/` (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å HTTP –±–µ–∑ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞)

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –∫–æ–Ω—Ñ–∏–≥ nginx

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω `try_files $uri =404;` –∏ —É–±—Ä–∞–Ω —Ä–µ–¥–∏—Ä–µ–∫—Ç –¥–ª—è ACME challenge:

```nginx
location /.well-known/acme-challenge/ {
    root /var/www/html;
    try_files $uri =404;  # ‚Üê –î–æ–±–∞–≤–ª–µ–Ω–æ
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** HTTP –∑–∞–ø—Ä–æ—Å—ã –∫ `/.well-known/acme-challenge/` –±–æ–ª—å—à–µ –ù–ï —Ä–µ–¥–∏—Ä–µ–∫—Ç—è—Ç—Å—è –Ω–∞ HTTPS.

### 2. –ü—Ä–æ–±–ª–µ–º–∞ —Å DNS

**–¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:**
- DNS –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç: `35.194.39.8` –∏ `159.255.37.158`
- –¢–µ–∫—É—â–∏–π VPS IP: `159.255.37.158`
- Certbot –ø—ã—Ç–∞–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á–µ—Ä–µ–∑ `35.194.39.8` (—Å—Ç–∞—Ä—ã–π IP)

**–†–µ—à–µ–Ω–∏–µ:**
–ù—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å DNS A-–∑–∞–ø–∏—Å—å –¥–ª—è `api.2wix.ru`, —á—Ç–æ–±—ã –æ–Ω–∞ —É–∫–∞–∑—ã–≤–∞–ª–∞ **–¢–û–õ–¨–ö–û** –Ω–∞ `159.255.37.158`.

---

## üîß –®–∞–≥–∏ –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –®–∞–≥ 1: –û–±–Ω–æ–≤–∏—Ç—å DNS

1. –í–æ–π–¥–∏—Ç–µ –≤ –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è DNS (–≥–¥–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–æ–º–µ–Ω 2wix.ru)
2. –ù–∞–π–¥–∏—Ç–µ A-–∑–∞–ø–∏—Å—å –¥–ª—è `api.2wix.ru`
3. –£–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä—ã–π IP `35.194.39.8`
4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ **–¢–û–õ–¨–ö–û** `159.255.37.158`
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
6. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 5-10 –º–∏–Ω—É—Ç –¥–ª—è —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è DNS

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å DNS

```bash
ssh shortsai-vps
dig +short api.2wix.ru
# –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –¢–û–õ–¨–ö–û: 159.255.37.158
```

### –®–∞–≥ 3: –ü–æ–≤—Ç–æ—Ä–∏—Ç—å certbot

```bash
ssh shortsai-vps
sudo certbot --nginx -d api.2wix.ru
```

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ ACME path —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞:

```bash
curl -I http://api.2wix.ru/.well-known/acme-challenge/test
# –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å: HTTP/1.1 404 Not Found (–Ω–µ 301!)
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å DNS:

```bash
dig +short api.2wix.ru
# –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –¢–û–õ–¨–ö–û: 159.255.37.158
```

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∏–∑–≤–Ω–µ:

```bash
# –° –¥—Ä—É–≥–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –∏–ª–∏ —á–µ—Ä–µ–∑ –æ–Ω–ª–∞–π–Ω-—Å–µ—Ä–≤–∏—Å
curl -I http://api.2wix.ru/.well-known/acme-challenge/test
# –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 404 (–Ω–µ timeout!)
```

---

## üîç Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: Certbot –≤—Å–µ –µ—â–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è DNS

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 10-15 –º–∏–Ω—É—Ç –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è DNS
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ DNS —Å —Ä–∞–∑–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤:
   ```bash
   dig @8.8.8.8 api.2wix.ru
   dig @1.1.1.1 api.2wix.ru
   ```
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ certbot —Å —Ñ–ª–∞–≥–æ–º `--dry-run`:
   ```bash
   sudo certbot --nginx -d api.2wix.ru --dry-run
   ```

### –ü—Ä–æ–±–ª–µ–º–∞: Timeout –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π—Ä–≤–æ–ª:
   ```bash
   sudo ufw status
   # –ü–æ—Ä—Ç 80 –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç–∫—Ä—ã—Ç
   ```
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ nginx —Å–ª—É—à–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 80:
   ```bash
   sudo ss -lntp | grep :80
   ```
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∏–∑–≤–Ω–µ:
   ```bash
   # –° –¥—Ä—É–≥–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
   curl -I http://159.255.37.158/.well-known/acme-challenge/test
   ```

---

## üìã –†–µ–∑—é–º–µ

‚úÖ **–ö–æ–Ω—Ñ–∏–≥ nginx –∏—Å–ø—Ä–∞–≤–ª–µ–Ω** - ACME challenge –±–æ–ª—å—à–µ –Ω–µ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç—Å—è  
‚ö†Ô∏è **–¢—Ä–µ–±—É–µ—Ç—Å—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ DNS** - —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π IP `35.194.39.8`  
‚úÖ **–§–∞–π—Ä–≤–æ–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω** - –ø–æ—Ä—Ç 80 –æ—Ç–∫—Ä—ã—Ç  
‚úÖ **Nginx —Ä–∞–±–æ—Ç–∞–µ—Ç** - —Å–ª—É—à–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç–∞—Ö 80 –∏ 443  

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –û–±–Ω–æ–≤–∏—Ç—å DNS –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å certbot.

---

**–î–∞—Ç–∞:** 2026-01-08
