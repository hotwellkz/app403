# üåê –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤–Ω–µ—à–Ω–µ–≥–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –∫ –ª–æ–∫–∞–ª—å–Ω–æ–º—É —Å–µ—Ä–≤–µ—Ä—É

## üéØ –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è https://2wix.ru

### 1. **–°–æ–∑–¥–∞–π—Ç–µ .env —Ñ–∞–π–ª**

–í –ø–∞–ø–∫–µ `whatsapp-server/` —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env`:

```env
# Server Configuration
PORT=3000
NODE_ENV=development

# Frontend URLs
FRONTEND_URL=http://localhost:5173
ALLOWED_ORIGINS=https://2wix.ru,http://localhost:5173

# WhatsApp Configuration
WHATSAPP_SESSION_PATH=./.wwebjs_auth
FORCE_LOCAL_MODE=true

# Supabase (–æ—Ç–∫–ª—é—á–µ–Ω–æ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
SUPABASE_ENABLED=false

# Logging
LOG_LEVEL=info
```

### 2. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä**

```bash
cd whatsapp-server
npm run dev
```

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –ª–æ–≥–∞—Ö:
```
üîó Allowed CORS origins: [ 'https://2wix.ru', 'http://localhost:3000', 'http://localhost:5173', ... ]
```

### 3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ ngrok –¥–ª—è HTTPS** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–¢–∞–∫ –∫–∞–∫ –≤–∞—à —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ HTTPS, –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HTTPS —Ç—É–Ω–Ω–µ–ª—å:

```bash
# –°–∫–∞—á–∞–π—Ç–µ ngrok: https://ngrok.com/download
ngrok http 3000
```

–ü–æ–ª—É—á–∏—Ç–µ URL —Ç–∏–ø–∞: `https://abc123.ngrok.io`

### 4. **–û–±–Ω–æ–≤–∏—Ç–µ API URL –≤ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ**

–í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –≤–∞—à–µ–≥–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –∏–∑–º–µ–Ω–∏—Ç–µ:

```typescript
// –í–º–µ—Å—Ç–æ http://localhost:3000 –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ ngrok URL
const WHATSAPP_API_URL = 'https://abc123.ngrok.io';
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

1. –û—Ç–∫—Ä–æ–π—Ç–µ `https://abc123.ngrok.io/health` - –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ CORS –æ—à–∏–±–æ–∫
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏ WhatsApp

## üö® –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### Service Worker –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã

–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫–∏ Service Worker:

1. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12)
2. Application ‚Üí Service Workers
3. Unregister –≤—Å–µ –≤–æ—Ä–∫–µ—Ä—ã
4. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É

### CORS –æ—à–∏–±–∫–∏

–ï—Å–ª–∏ –≤—Å—ë –µ—â—ë –≤–∏–¥–∏—Ç–µ CORS –æ—à–∏–±–∫–∏:

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è .env
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ origins
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ ngrok –¥–ª—è HTTPS —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ—Ä—Ç–æ–º

–ï—Å–ª–∏ –ø–æ—Ä—Ç 3000 –∑–∞–Ω—è—Ç:

```env
# –í .env –∏–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—Ç
PORT=3001
```

–ò –æ–±–Ω–æ–≤–∏—Ç–µ ngrok:
```bash
ngrok http 3001
```

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:

```
‚úÖ WhatsApp client initialized successfully
üì± Account info updated: { phoneNumber: '77475000217@c.us', name: '–í–∏—Ç–∞–ª–∏–π' }
ü©∫ Health check: HEALTHY - WhatsApp: READY
```

–ò –≤–∞—à —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ —Å–º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –±–µ–∑ CORS –æ—à–∏–±–æ–∫! üéâ 